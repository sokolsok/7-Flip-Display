(function(){"use strict";var e={7149:function(e,r,a){var t=a(5130),n=a(6768);const o={class:"app"};function i(e,r,a,t,i,l){const u=(0,n.g2)("UpdateCheck");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(u)])}var l=a(4232),u=a(144);const s={class:"update-check"},v={class:"label"},c={key:0},p={key:0},f={key:1},d=["value"],w={key:2};var h={__name:"UpdateCheck",setup(e){const r=(0,u.KR)(""),a=(0,u.KR)(""),t=(0,u.KR)(""),o=(0,u.KR)(""),i=(0,u.KR)(!1),h=(0,u.KR)(""),m=(0,u.KR)(0),b=(0,u.KR)(!1),y=(0,u.KR)("");async function _(){try{const e=await fetch("/api/v1/versions"),t=await e.json();r.value=t.versions.firm_version,a.value=t.versions.web_app_version}catch(e){y.value="Error fetching installed versions",console.error("Error fetching installed versions:",e)}}async function g(){try{const e=await fetch("https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/version.json"),r=await e.json();t.value=r.firmware.version,o.value=r.web_app.version}catch(e){y.value="Error fetching available versions",console.error("Error fetching available versions:",e)}}function O(){r.value!==t.value||a.value!==o.value?i.value=!0:i.value=!1}let k=null;function A(){k=setInterval((async()=>{try{const e=await fetch("/api/v1/ota/progress"),r=await e.json();m.value=r.progress,r.progress>=100&&(clearInterval(k),setTimeout((()=>{window.location.reload()}),1e3))}catch(e){console.error("Error polling OTA progress:",e)}}),1e3)}async function E(){b.value=!0,m.value=0;const e=r.value!==t.value,n=a.value!==o.value;if(e&&n){h.value="Updating Web-App and Firmware...";try{const e=await fetch("/api/v1/ota/both",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firmware_url:`https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/firmware_v${t.value}.bin`,web_app_url:`https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/web_app_v${o.value}.bin`})}),r=await e.text();y.value=r,A()}catch(i){y.value="Error starting combined OTA update",console.error("Combined OTA error:",i)}}else if(e){h.value="Updating firmware...";try{const e=await fetch("/api/v1/ota/firmware",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:`https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/firmware_v${t.value}.bin`})}),r=await e.text();y.value=r,A()}catch(i){y.value="Error starting firmware OTA update",console.error("Firmware OTA error:",i)}}else if(n){h.value="Updating Web-App...";try{const e=await fetch("/api/v1/ota/web_app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:`https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/web_app_v${o.value}.bin`})}),r=await e.text();y.value=r,A()}catch(i){y.value="Error starting Web-App OTA update",console.error("Web-App OTA error:",i)}}}return(0,n.sV)((async()=>{await _(),await g(),O()})),(e,u)=>((0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",v,[(0,n.Lk)("p",null,"Installed Firmware: "+(0,l.v_)(r.value)+" | Web App: "+(0,l.v_)(a.value),1),i.value?((0,n.uX)(),(0,n.CE)("p",c,"Nev Firmware: "+(0,l.v_)(t.value)+" | Web App: "+(0,l.v_)(o.value),1)):(0,n.Q3)("",!0)]),b.value?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",p,[i.value?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:E},"UPDATE AVAILABLE")):(0,n.Q3)("",!0)])),b.value?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.Lk)("div",null,(0,l.v_)(h.value),1),(0,n.Lk)("progress",{max:"100",value:m.value},null,8,d),(0,n.Lk)("div",null,(0,l.v_)(m.value)+"%",1)])):(0,n.Q3)("",!0),y.value?((0,n.uX)(),(0,n.CE)("div",w,(0,l.v_)(y.value),1)):(0,n.Q3)("",!0)]))}},m=a(1241);const b=(0,m.A)(h,[["__scopeId","data-v-1fa74111"]]);var y=b,_={name:"App",components:{UpdateCheck:y}};const g=(0,m.A)(_,[["render",i]]);var O=g;(0,t.Ef)(O).mount("#app")}},r={};function a(t){var n=r[t];if(void 0!==n)return n.exports;var o=r[t]={exports:{}};return e[t].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(r,t,n,o){if(!t){var i=1/0;for(v=0;v<e.length;v++){t=e[v][0],n=e[v][1],o=e[v][2];for(var l=!0,u=0;u<t.length;u++)(!1&o||i>=o)&&Object.keys(a.O).every((function(e){return a.O[e](t[u])}))?t.splice(u--,1):(l=!1,o<i&&(i=o));if(l){e.splice(v--,1);var s=n();void 0!==s&&(r=s)}}return r}o=o||0;for(var v=e.length;v>0&&e[v-1][2]>o;v--)e[v]=e[v-1];e[v]=[t,n,o]}}(),function(){a.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(r,{a:r}),r}}(),function(){a.d=function(e,r){for(var t in r)a.o(r,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){var e={524:0};a.O.j=function(r){return 0===e[r]};var r=function(r,t){var n,o,i=t[0],l=t[1],u=t[2],s=0;if(i.some((function(r){return 0!==e[r]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(u)var v=u(a)}for(r&&r(t);s<i.length;s++)o=i[s],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(v)},t=self["webpackChunk_7_flip_display"]=self["webpackChunk_7_flip_display"]||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))}();var t=a.O(void 0,[504],(function(){return a(7149)}));t=a.O(t)})();
//# sourceMappingURL=app.fb35d0c3.js.map