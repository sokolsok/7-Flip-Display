(function(){"use strict";var e={9838:function(e,t,o){var a=o(5130),n=o(6768);function r(e,t,o,r,i,s){const l=(0,n.g2)("UpdateCheck"),u=(0,n.g2)("WifiConfig"),c=(0,n.g2)("MqttData");return(0,n.uX)(),(0,n.CE)(n.FK,null,[t[2]||(t[2]=(0,n.Lk)("h1",null,"7-Flip Display v.0.5",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.number=t),placeholder:"Wpisz liczbę"},null,512),[[a.Jo,e.number]]),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.sendScore&&s.sendScore(...e))},"SEND"),t[3]||(t[3]=(0,n.Lk)("br",null,null,-1)),t[4]||(t[4]=(0,n.Lk)("br",null,null,-1)),(0,n.bF)(l),t[5]||(t[5]=(0,n.Lk)("br",null,null,-1)),(0,n.bF)(u),t[6]||(t[6]=(0,n.Lk)("br",null,null,-1)),(0,n.bF)(c)],64)}function i(e,t,o,a,r,i){return r.showBlock?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"block",onClick:t[0]||(t[0]=(...e)=>i.stopTimer&&i.stopTimer(...e))}," click me ")):(0,n.Q3)("",!0)}var s={props:["delay"],data(){return{showBlock:!1,timer:null,reactionTime:0}},mounted(){setTimeout((()=>{this.showBlock=!0,this.startTimer()}),this.delay)},methods:{startTimer(){this.timer=setInterval((()=>{this.reactionTime+=10}),10)},stopTimer(){clearInterval(this.timer),this.$emit("end",this.reactionTime)}}},l=o(1241);const u=(0,l.A)(s,[["render",i]]);var c=u,p=o(4232);const d={class:"ersult"};function v(e,t,o,r,i,s){return(0,n.uX)(),(0,n.CE)("div",{class:"backdrop",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>s.closeScore&&s.closeScore(...e)),["self"]))},[(0,n.Lk)("div",d,[t[1]||(t[1]=(0,n.Lk)("p",null,"Twój czas to:",-1)),(0,n.Lk)("h1",null,(0,p.v_)(o.score),1)])])}var f={props:["score"],methods:{closeScore(){this.$emit("close")}}};const h=(0,l.A)(f,[["render",v]]);var m=h,b=o(4373),w=o(144);const k={class:"wifi-config"},y={key:0};var g={__name:"WifiConfig",setup(e){const t=(0,w.KR)(""),o=(0,w.KR)("AP"),r=(0,w.KR)(""),i=(0,w.KR)("");async function s(){try{const e=await fetch("/api/v1/mode");if(e.ok){const a=await e.json();t.value=a.mode,o.value=a.mode,r.value=a.ssid||"",i.value=""}else console.error("Failed to fetch configuration")}catch(e){console.error("Error fetching configuration:",e)}}async function l(){const e={mode:o.value};"STA"===o.value&&(e.ssid=r.value,e.password=i.value);try{const t=await fetch("/api/v1/mode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){const e=await t.text();alert(e)}else alert("Failed to update configuration")}catch(t){console.error("Error updating configuration:",t),alert("Error updating configuration")}}return(0,n.sV)((()=>{s()})),(e,s)=>((0,n.uX)(),(0,n.CE)("div",k,[s[8]||(s[8]=(0,n.Lk)("h2",null,"Wi-Fi Configuration",-1)),(0,n.Lk)("div",null,[(0,n.Lk)("label",null,"Current Mode: "+(0,p.v_)(t.value),1)]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"radio",id:"ap",value:"AP","onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e)},null,512),[[a.XL,o.value]]),s[4]||(s[4]=(0,n.Lk)("label",{for:"ap"},"Access Point (Hotspot)",-1)),(0,n.bo)((0,n.Lk)("input",{type:"radio",id:"sta",value:"STA","onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e)},null,512),[[a.XL,o.value]]),s[5]||(s[5]=(0,n.Lk)("label",{for:"sta"},"Wi-Fi Client (Station)",-1))]),"STA"===o.value?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.Lk)("div",null,[s[6]||(s[6]=(0,n.Lk)("label",{for:"ssid"},"SSID:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"ssid","onUpdate:modelValue":s[2]||(s[2]=e=>r.value=e),placeholder:"Enter SSID"},null,512),[[a.Jo,r.value]])]),(0,n.Lk)("div",null,[s[7]||(s[7]=(0,n.Lk)("label",{for:"password"},"Password:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":s[3]||(s[3]=e=>i.value=e),placeholder:"Enter password"},null,512),[[a.Jo,i.value]])])])):(0,n.Q3)("",!0),(0,n.Lk)("button",{onClick:l},"Update Configuration")]))}};const L=(0,l.A)(g,[["__scopeId","data-v-ec3cc352"]]);var A=L;o(8111),o(2489),o(1701);const T={class:"mqtt-data"},C={style:{display:"flex","align-items":"center"}},S={key:0};var V={__name:"MqttData",setup(e){const t=(0,w.KR)({enabled:!1,broker:"",port:1883,login:"",password:"",topics:""}),o=(0,w.KR)(""),r=async()=>{try{const e=await fetch("/api/v1/mqtt");if(!e.ok)throw new Error("Failed to fetch configuration");const o=await e.json();t.value.enabled=o.enabled,t.value.broker=o.broker,t.value.port=o.port,t.value.login=o.login,t.value.password="",t.value.topics=Array.isArray(o.topics)?o.topics.join(","):o.topics}catch(e){o.value=e.message}},i=async()=>{try{const e={enabled:t.value.enabled,host:t.value.broker,port:t.value.port,login:t.value.login,password:t.value.password,topics:t.value.topics.split(",").map((e=>e.trim())).filter((e=>""!==e))},a=await fetch("/api/v1/mqtt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){const e=await a.text();throw new Error(e||"Failed to save configuration")}o.value="Configuration saved successfully"}catch(e){o.value=e.message}};return(0,n.sV)((()=>{r()})),(e,r)=>((0,n.uX)(),(0,n.CE)("div",T,[r[8]||(r[8]=(0,n.Lk)("h2",null,"MQTT Configuration",-1)),(0,n.Lk)("form",{onSubmit:(0,a.D$)(i,["prevent"])},[(0,n.Lk)("div",C,[r[6]||(r[6]=(0,n.Lk)("label",{for:"enabled"},"Enable MQTT:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"enabled","onUpdate:modelValue":r[0]||(r[0]=e=>t.value.enabled=e)},null,512),[[a.lH,t.value.enabled]])]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"text",id:"broker","onUpdate:modelValue":r[1]||(r[1]=e=>t.value.broker=e),placeholder:"Broker Address"},null,512),[[a.Jo,t.value.broker]])]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"number",id:"port","onUpdate:modelValue":r[2]||(r[2]=e=>t.value.port=e),placeholder:"Port"},null,512),[[a.Jo,t.value.port,void 0,{number:!0}]])]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"text",id:"login","onUpdate:modelValue":r[3]||(r[3]=e=>t.value.login=e),placeholder:"Login"},null,512),[[a.Jo,t.value.login]])]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":r[4]||(r[4]=e=>t.value.password=e),placeholder:"Password"},null,512),[[a.Jo,t.value.password]])]),(0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("input",{type:"text",id:"topics","onUpdate:modelValue":r[5]||(r[5]=e=>t.value.topics=e),placeholder:"Topics"},null,512),[[a.Jo,t.value.topics]])]),r[7]||(r[7]=(0,n.Lk)("button",{type:"submit"},"Save Configuration",-1))],32),o.value?((0,n.uX)(),(0,n.CE)("p",S,(0,p.v_)(o.value),1)):(0,n.Q3)("",!0)]))}};const O=(0,l.A)(V,[["__scopeId","data-v-d9baf7f0"]]);var j=O;const _={class:"kupa"},E=["disabled"],F=["disabled"];function x(e,t,o,a,r,i){return(0,n.uX)(),(0,n.CE)("div",_,[(0,n.Lk)("p",null,(0,p.v_)(r.message),1),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.checkVersions&&i.checkVersions(...e))},"Sprawdź wersje"),t[3]||(t[3]=(0,n.Lk)("br",null,null,-1)),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.startFirmwareOTA&&i.startFirmwareOTA(...e)),disabled:!r.firmwareVersion}," Aktualizuj Firmware (v"+(0,p.v_)(r.firmwareVersion)+") ",9,E),(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.startWebAppOTA&&i.startWebAppOTA(...e)),disabled:!r.webAppVersion}," Aktualizuj Aplikację Web (v"+(0,p.v_)(r.webAppVersion)+") ",9,F)])}var P={data(){return{message:"Kliknij przycisk, aby sprawdzić wersje",firmwareVersion:null,webAppVersion:null}},methods:{async checkVersions(){try{const e=await fetch("https://download.smartsolutions4home.com/7-flip-firmware/version.json");if(!e.ok)throw new Error("Brak dostępu do serwera");const t=await e.json();console.log("Fetched JSON:",t),this.firmwareVersion=t.firmware?.version||null,this.webAppVersion=t.web_app?.version||null,this.message=`Dostępne wersje: Firmware v${this.firmwareVersion} | Web App v${this.webAppVersion}`}catch(e){this.message=`Wystąpił błąd: ${e.message}`}},async startFirmwareOTA(){if(!this.firmwareVersion)return void(this.message="Najpierw sprawdź wersje!");const e=`https://download.smartsolutions4home.com/7-flip-firmware/firmware_v${this.firmwareVersion}.bin`;try{const t=await fetch("/api/v1/ota/firmware",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!t.ok)throw new Error("Błąd podczas wywoływania OTA firmware");const o=await t.text();this.message=o}catch(t){this.message=`Wystąpił błąd: ${t.message}`}},async startWebAppOTA(){if(!this.webAppVersion)return void(this.message="Najpierw sprawdź wersje!");const e=`https://download.smartsolutions4home.com/7-flip-firmware/web_app_v${this.webAppVersion}.bin`;try{const t=await fetch("/api/v1/ota/web_app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!t.ok)throw new Error("Błąd podczas wywoływania OTA web app");const o=await t.text();this.message=o}catch(t){this.message=`Wystąpił błąd: ${t.message}`}}}};const U=(0,l.A)(P,[["render",x],["__scopeId","data-v-427c21b0"]]);var W=U,J={name:"App",components:{Block:c,Results:m,WifiConfig:A,MqttData:j,UpdateCheck:W},data(){return{isPlaying:!1,delay:null,score:null,showResult:!1,displayValue:null}},methods:{start(){this.delay=2e3+5e3*Math.random(),this.isPlaying=!0,this.showResult=!1},async sendScore(){try{const e=await b.A.post("/api/v1/mannual",{score:this.number});console.log("Odpowiedź serwera:",e.data)}catch(e){console.error("Błąd przy wysyłaniu:",e)}}},mounted(){b.A.get("/api/v1/display").then((e=>{this.displayValue=e.data.display})).catch((e=>{console.error("Error fetching display value:",e)}))}};const $=(0,l.A)(J,[["render",r]]);var z=$;(0,a.Ef)(z).mount("#app")}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,n,r){if(!a){var i=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],r=e[c][2];for(var s=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[l])}))?a.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,r,i=a[0],s=a[1],l=a[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var c=l(o)}for(t&&t(a);u<i.length;u++)r=i[u],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self["webpackChunkreaction_timer"]=self["webpackChunkreaction_timer"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(9838)}));a=o.O(a)})();