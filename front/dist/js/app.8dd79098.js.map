{"version":3,"file":"js/app.8dd79098.js","mappings":"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","sources":["webpack://7_flip_display/./src/App.vue","webpack://7_flip_display/./src/components/UpdateCheck.vue","webpack://7_flip_display/./src/components/UpdateCheck.vue?92be","webpack://7_flip_display/./src/components/WifiConfig.vue","webpack://7_flip_display/./src/components/WifiConfig.vue?1743","webpack://7_flip_display/./src/components/MqttData.vue","webpack://7_flip_display/./src/components/MqttData.vue?0fb8","webpack://7_flip_display/./src/App.vue?7ccd","webpack://7_flip_display/./src/main.js","webpack://7_flip_display/webpack/bootstrap","webpack://7_flip_display/webpack/runtime/chunk loaded","webpack://7_flip_display/webpack/runtime/compat get default export","webpack://7_flip_display/webpack/runtime/define property getters","webpack://7_flip_display/webpack/runtime/global","webpack://7_flip_display/webpack/runtime/hasOwnProperty shorthand","webpack://7_flip_display/webpack/runtime/jsonp chunk loading","webpack://7_flip_display/webpack/startup"],"sourcesContent":["<template>\n  <div class=\"app\">\n    <UpdateCheck />\n    <WifiConfig />\n    <MqttData />\n  </div>\n</template>\n\n<script>\nimport UpdateCheck from './components/UpdateCheck.vue';\nimport WifiConfig from './components/WifiConfig.vue';\nimport MqttData from './components/MqttData.vue';\n\nexport default {\n  name: 'App',\n  components: {UpdateCheck, WifiConfig, MqttData}\n}\n</script>\n\n<style>\nbody {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  margin: 0;\n  background: #dee3e9;\n  display: block;\n}\n</style>\n","<template>\r\n  <div class=\"update-check\">\r\n    <h3>Versions</h3>\r\n    <div class=\"label\">\r\n      <p>\r\n        Firmware:\r\n        {{ installedFirmwareVersion }}\r\n        <span\r\n          v-if=\"firmwareState === 'update'\"\r\n          style=\"color: green\"\r\n        >({{ availableFirmwareVersion }})</span>\r\n        <span\r\n          v-else-if=\"firmwareState === 'offline'\"\r\n          style=\"color: red\"\r\n        >(N/A)</span>\r\n        |\r\n        Web App:\r\n        {{ installedWebAppVersion }}\r\n        <span\r\n          v-if=\"webAppState === 'update'\"\r\n          style=\"color: green\"\r\n        >({{ availableWebAppVersion }})</span>\r\n        <span\r\n          v-else-if=\"webAppState === 'offline'\"\r\n          style=\"color: red\"\r\n        >(N/A)</span>\r\n      </p>\r\n    </div>\r\n\r\n    <div v-if=\"!showProgress\">\r\n      <button v-if=\"updateAvailable\" @click=\"startUpdate\">UPDATE AVAILABLE</button>\r\n    </div>\r\n\r\n    <div  class=\"progress-container\" v-if=\"showProgress\">\r\n      <div class=\"label\">{{ updateLabel }}</div>\r\n        <div class=\"progress-wrapper\">\r\n          <progress max=\"100\" :value=\"progress\"></progress>\r\n          <div class=\"progress-percent\">{{ progress }}%</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\n\r\n// Reactive state variables\r\nconst installedFirmwareVersion = ref('');\r\nconst installedWebAppVersion = ref('');\r\nconst availableFirmwareVersion = ref('');\r\nconst availableWebAppVersion = ref('');\r\nconst updateAvailable = ref(false);\r\nconst firmwareState = ref(''); // '', 'update', 'offline'\r\nconst webAppState = ref(''); // '', 'update', 'offline'\r\nconst updateLabel = ref('');\r\nconst progress = ref(0);\r\nconst showProgress = ref(false);\r\nconst message = ref('');\r\nconst updateInProgress = ref(false)\r\n\r\n// Function to fetch versions from ESP32\r\nasync function fetchInstalledVersions() {\r\n  try {\r\n    const response = await fetch('/api/v1/versions');\r\n    //const response = await fetch('http://localhost:3000/versions');\r\n    const data = await response.json();\r\n    installedFirmwareVersion.value = data.versions.firm_version;\r\n    installedWebAppVersion.value = data.versions.web_app_version;\r\n  } catch (error) {\r\n    message.value = 'Error fetching installed versions';\r\n    console.error('Error fetching installed versions:', error);\r\n  }\r\n}\r\n\r\n// Function to fetch available versions from external OTA server\r\nasync function fetchAvailableVersions() {\r\n  try {\r\n    const response = await fetch('https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/version.json');\r\n    const data = await response.json();\r\n    availableFirmwareVersion.value = data.firmware_version;\r\n    availableWebAppVersion.value = data.web_app_version;\r\n  } catch (error) {\r\n    firmwareState.value = 'offline';\r\n    webAppState.value = 'offline';\r\n    return;\r\n  }\r\n  firmwareState.value = installedFirmwareVersion.value !== availableFirmwareVersion.value ? 'update' : '';\r\n  webAppState.value = installedWebAppVersion.value !== availableWebAppVersion.value ? 'update' : '';\r\n\r\n  updateAvailable.value = firmwareState.value === 'update' || webAppState.value === 'update';\r\n}\r\n\r\n// Function to check if an update is needed\r\nfunction checkForUpdate() {\r\n  // Compare installed and available versions\r\n  if (\r\n    (installedFirmwareVersion.value !== availableFirmwareVersion.value ||\r\n    installedWebAppVersion.value !== availableWebAppVersion.value) && \r\n    (firmwareState.value !== 'offline' && \r\n    webAppState.value !== 'offline')\r\n  ) {\r\n    updateAvailable.value = true;\r\n  } else {\r\n    updateAvailable.value = false;\r\n  }\r\n}\r\n\r\n// Function to start progress polling\r\nlet progressInterval = null;\r\nfunction startProgressPolling() {\r\n  progressInterval = setInterval(async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/ota/progress');\r\n      const data = await response.json();\r\n      progress.value = data.progress;\r\n\r\n      if (progress.value > 0 && !updateInProgress.value) {\r\n        updateInProgress.value = true;\r\n      }\r\n\r\n      if (updateInProgress.value && progress.value === 0) {\r\n        clearInterval(progressInterval);\r\n        updateInProgress.value = false;\r\n        window.location.reload(); \r\n      }\r\n    } catch (error) {\r\n      console.error('Error polling OTA progress:', error);\r\n    }\r\n  }, 1000);\r\n}\r\n\r\n// Function to initiate OTA update based on version differences\r\nasync function startUpdate() {\r\n  showProgress.value = true;\r\n  progress.value = 0;\r\n\r\n  // Determine which components need update\r\n  const updateFirmware = installedFirmwareVersion.value !== availableFirmwareVersion.value;\r\n  const updateWebApp = installedWebAppVersion.value !== availableWebAppVersion.value;\r\n\r\n  // If both updates are needed, call combined endpoint\r\n  if (updateFirmware && updateWebApp) {\r\n    updateLabel.value = 'Updating Web-App and Firmware...';\r\n    try {\r\n      const response = await fetch('/api/v1/ota/both', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          firmware_url: `https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/firmware_v${availableFirmwareVersion.value}.bin`,\r\n          web_app_url: `https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/web_app_v${availableWebAppVersion.value}.bin`\r\n        })\r\n      });\r\n      const text = await response.text();\r\n      message.value = text;\r\n      startProgressPolling();\r\n    } catch (error) {\r\n      message.value = 'Error starting combined OTA update';\r\n      console.error('Combined OTA error:', error);\r\n    }\r\n  } else if (updateFirmware) {\r\n    // Only firmware update is needed\r\n    updateLabel.value = 'Updating firmware...';\r\n    try {\r\n      const response = await fetch('/api/v1/ota/firmware', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          url: `https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/firmware_v${availableFirmwareVersion.value}.bin`\r\n        })\r\n      });\r\n      const text = await response.text();\r\n      message.value = text;\r\n      startProgressPolling();\r\n    } catch (error) {\r\n      message.value = 'Error starting firmware OTA update';\r\n      console.error('Firmware OTA error:', error);\r\n    }\r\n  } else if (updateWebApp) {\r\n    // Only web app update is needed\r\n    updateLabel.value = 'Updating Web-App...';\r\n    try {\r\n      const response = await fetch('/api/v1/ota/web_app', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          url: `https://download.smartsolutions4home.com/ota-firmware/7-flip-firmware/web_app_v${availableWebAppVersion.value}.bin`\r\n        })\r\n      });\r\n      const text = await response.text();\r\n      message.value = text;\r\n      startProgressPolling();\r\n    } catch (error) {\r\n      message.value = 'Error starting Web-App OTA update';\r\n      console.error('Web-App OTA error:', error);\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  await fetchInstalledVersions();\r\n  await fetchAvailableVersions();\r\n  checkForUpdate();\r\n});\r\n</script>\r\n  \r\n<style scoped>\r\n.update-check {\r\n  max-width: 420px;\r\n  margin: 20px auto;\r\n  background: white;\r\n  text-align: left;\r\n  padding: 40px;\r\n  border-radius: 10px;\r\n}\r\n\r\n.label {\r\n  color: #333;\r\n  display: inline-block;\r\n  font-size: 0.7em;\r\n  text-transform: uppercase;\r\n  letter-spacing: 1px;\r\n  font-weight: bold;\r\n}\r\n\r\nh3 {\r\n      color: #333;\r\n      margin: 0 0 5px;\r\n      font-size: 0.9em;\r\n      text-transform: uppercase;\r\n      letter-spacing: 1px;\r\n      font-weight: 700;\r\n    }\r\n\r\nbutton {\r\n  background: #40464e;\r\n  border: 0;\r\n  padding: 10px 20px;\r\n  margin-top: 20px;\r\n  color: white;\r\n  border-radius: 20px;\r\n  cursor: pointer;\r\n  font-size: 0.7em;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.progress-container {\r\n  display: flex;\r\n  margin-top: 16px;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n}\r\n\r\n.progress-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\nprogress {\r\n  width: 390px;\r\n  height: 10px;\r\n  border: none;\r\n  border-radius: 5px;\r\n  -webkit-appearance: none;\r\n  appearance: none;\r\n}\r\n\r\n/* Chrome, Safari, Opera */\r\nprogress::-webkit-progress-bar {\r\n  background-color: #e6e6e6;\r\n  border-radius: 10px;\r\n}\r\n\r\nprogress::-webkit-progress-value {\r\n  background-color: #333;\r\n  border-radius: 10px;\r\n}\r\n\r\n/* Firefox */\r\nprogress::-moz-progress-bar {\r\n  background-color: #333;\r\n  border-radius: 10px;\r\n}\r\n</style>  ","import script from \"./UpdateCheck.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UpdateCheck.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UpdateCheck.vue?vue&type=style&index=0&id=3fee4cee&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3fee4cee\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"wifi-config\">\r\n      <h3>Wi-Fi Configuration</h3>\r\n      <div>\r\n        <label>Current Mode: {{ mode }}</label>\r\n      </div>\r\n      <div class=\"wifi-mode\">\r\n        <input type=\"radio\" id=\"ap\" value=\"AP\" v-model=\"selectedMode\">\r\n        <label for=\"ap\">Access Point</label>\r\n        <br/>\r\n        <input type=\"radio\" id=\"sta\" value=\"STA\" v-model=\"selectedMode\">\r\n        <label for=\"sta\">Wi-Fi Client</label>\r\n      </div>\r\n      <div v-if=\"selectedMode === 'STA'\">\r\n        <div>\r\n          <br>\r\n          <label for=\"ssid\">SSID:</label>\r\n          <input type=\"text\" id=\"ssid\" v-model=\"ssid\" />\r\n        </div>\r\n        <div>\r\n          <label for=\"password\">Password:</label>\r\n          <input type=\"password\" id=\"password\" v-model=\"password\" />\r\n        </div>\r\n      </div>\r\n      <button @click=\"updateConfig\">SAVE</button>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  \r\n  // Reactive variables for current mode, selected mode, SSID and password\r\n  const mode = ref('')\r\n  const selectedMode = ref('AP')\r\n  const ssid = ref('')\r\n  const password = ref('')\r\n  \r\n  // Function to fetch current configuration from the REST API endpoint GET /api/v1/mode\r\n  async function fetchConfig() {\r\n    try {\r\n      const response = await fetch('/api/v1/mode')\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        mode.value = data.mode\r\n        selectedMode.value = data.mode\r\n        ssid.value = data.ssid || ''\r\n        // For security reasons, the password is not returned by the API; leave it empty\r\n        password.value = ''\r\n      } else {\r\n        console.error('Failed to fetch configuration')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching configuration:', error)\r\n    }\r\n  }\r\n  \r\n  // Function to update configuration via POST /api/v1/mode.\r\n  // In STA mode, the SSID and password are included in the payload.\r\n  async function updateConfig() {\r\n    const payload = {\r\n      mode: selectedMode.value\r\n    }\r\n    if (selectedMode.value === 'STA') {\r\n      payload.ssid = ssid.value\r\n      payload.password = password.value\r\n    }\r\n    try {\r\n      const response = await fetch('/api/v1/mode', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(payload)\r\n      })\r\n      if (response.ok) {\r\n        const message = await response.text()\r\n        alert(message)\r\n      } else {\r\n        alert('Failed to update configuration')\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating configuration:', error)\r\n      alert('Error updating configuration')\r\n    }\r\n  }\r\n  \r\n  // On component mount, fetch the current configuration\r\n  onMounted(() => {\r\n    fetchConfig()\r\n  })\r\n  </script>\r\n  \r\n  <style scoped>\r\n    label {\r\n        color: #333;\r\n        /* display: inline-block; */\r\n        margin: 25px 0 15px;\r\n        font-size: 0.6em;\r\n        text-transform: uppercase;\r\n        letter-spacing: 1px;\r\n        font-weight: bold;\r\n    }\r\n    input, select {\r\n        display: block;\r\n        padding: 10px 6px;\r\n        width: 100%;\r\n        box-sizing: border-box;\r\n        border: none;\r\n        border: 1px solid #ddd;\r\n        color: #555;\r\n    }\r\n    .wifi-config {\r\n        max-width: 420px;\r\n        margin: 30px auto;\r\n        background: white;\r\n        /* text-align: center; */\r\n        padding: 40px;\r\n        border-radius: 10px;\r\n    }\r\n    h3 {\r\n      color: #333;\r\n      margin: 0 0 15px;\r\n      font-size: 0.9em;\r\n      text-transform: uppercase;\r\n      letter-spacing: 1px;\r\n      font-weight: 700;\r\n    }\r\n    input[type=\"radio\"] {\r\n        display: inline-block;\r\n        accent-color: #333;\r\n        width: 16px;\r\n        margin: 5px 10px 0 0;\r\n        position: relative;\r\n        top: 2px;\r\n    }\r\n    button {\r\n      background: #333;\r\n      border: 0;\r\n      padding: 10px 20px;\r\n      margin-top: 20px;\r\n      color: white;\r\n      border-radius: 20px;\r\n      cursor: pointer;\r\n      font-size: 0.7em;\r\n      text-transform: uppercase;\r\n    }\r\n  </style>\r\n  ","import script from \"./WifiConfig.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./WifiConfig.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./WifiConfig.vue?vue&type=style&index=0&id=13b671e4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-13b671e4\"]])\n\nexport default __exports__","<template>\r\n  <form @submit.prevent=\"saveConfig\">\r\n\r\n    <h3>MQTT Configuration</h3>\r\n\r\n    <div>\r\n      <input type=\"checkbox\" @input=\"onInputChange\" id=\"enabled\" v-model=\"config.enabled\" />\r\n      <label for=\"enabled\">Enable MQTT</label>\r\n    </div>\r\n\r\n    <div .class=\"settings\" v-if=\"config.enabled === true\">\r\n      <div>\r\n        <br>\r\n        <label>Broker Address:</label>\r\n        <input type=\"text\" @input=\"onInputChange\" id=\"broker\" v-model=\"config.broker\" />\r\n      </div>\r\n\r\n      <div>\r\n        <label>Port number:</label>\r\n        <input type=\"number\" @input=\"onInputChange\" id=\"port\" v-model.number=\"config.port\"/>\r\n      </div>\r\n\r\n      <div>\r\n        <label>Login:</label>\r\n        <input type=\"text\" @input=\"onInputChange\" id=\"login\" v-model=\"config.login\" />\r\n      </div>\r\n\r\n      <div>\r\n        <label>PAssword:</label>\r\n        <input type=\"password\" @input=\"onInputChange\" id=\"password\" v-model=\"config.password\" />\r\n      </div>\r\n    </div>\r\n\r\n    <button type=\"submit\" v-if=\"showSaveButton === true\">{{ SaveButtonLabel }}</button>\r\n    \r\n  </form>\r\n\r\n</template>\r\n  \r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\n  \r\n  // Configuration object\r\n  const config = ref({\r\n    enabled: false,\r\n    broker: '',\r\n    port: '',\r\n    login: '',\r\n    password: '',\r\n  })\r\n\r\n  const showSaveButton = ref(false);\r\n  const SaveButtonLabel = ref('SAVE');\r\n  \r\n  // Message to display feedback\r\n  const message = ref('')\r\n  \r\n  // Fetch current MQTT configuration from REST endpoint\r\n  const fetchConfig = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/mqtt')\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch configuration')\r\n      }\r\n      const data = await response.json()\r\n      config.value.enabled = data.enabled\r\n      config.value.broker = data.broker\r\n      config.value.port = data.port\r\n      config.value.login = data.login\r\n      config.value.password = data.password\r\n    } catch (error) {\r\n      message.value = error.message\r\n    }\r\n  }\r\n\r\n  const onInputChange = () => {\r\n      showSaveButton.value = true\r\n  }\r\n  \r\n  // Save configuration by sending POST request to REST endpoint\r\n  const saveConfig = async () => {\r\n    try {\r\n      const payload = {\r\n        enabled: config.value.enabled,\r\n        host: config.value.broker,\r\n        port: config.value.port,\r\n        login: config.value.login,\r\n        password: config.value.password,\r\n      }\r\n      const response = await fetch('/api/v1/mqtt', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload),\r\n      })\r\n      if (!response.ok) {\r\n        const errText = await response.text()\r\n        throw new Error(errText || 'Failed to save configuration')\r\n      }\r\n      message.value = 'Configuration saved successfully'\r\n      SaveButtonLabel.value = 'SAVED'\r\n    } catch (error) {\r\n      message.value = error.message\r\n    }\r\n  }\r\n  \r\n  onMounted(() => {\r\n    fetchConfig()\r\n  })\r\n  </script>\r\n  \r\n  <style scoped>\r\n    form {\r\n        max-width: 420px;\r\n        margin: 30px auto;\r\n        background: white;\r\n        text-align: left;\r\n        padding: 40px;\r\n        border-radius: 10px;\r\n    }\r\n    h3 {\r\n      color: #333;\r\n      margin: 0 0 15px;\r\n      font-size: 0.9em;\r\n      text-transform: uppercase;\r\n      letter-spacing: 1px;\r\n      font-weight: 700;\r\n    }\r\n    label {\r\n        color: #333;\r\n        display: inline-block;\r\n        margin: 5px 0 0px;\r\n        font-size: 0.6em;\r\n        text-transform: uppercase;\r\n        letter-spacing: 1px;\r\n        font-weight: bold;\r\n    }\r\n    input, select {\r\n        display: inline-block;\r\n        padding: 10px 6px;\r\n        width: 100%;\r\n        box-sizing: border-box;\r\n        border: none;\r\n        border: 1px solid #ddd;\r\n        accent-color: #333;\r\n    }\r\n    input[type=\"checkbox\"] {\r\n        display: inline-block;\r\n        width: 16px;\r\n        margin: 0 10px 0 0;\r\n        position: relative;\r\n        top: 3px;\r\n    }\r\n    button {\r\n      background: #333;\r\n      border: 0;\r\n      padding: 10px 20px;\r\n      margin-top: 20px;\r\n      color: white;\r\n      border-radius: 20px;\r\n      cursor: pointer;\r\n      font-size: 0.7em;\r\n      text-transform: uppercase;\r\n    }\r\n    .submit {\r\n        text-align: center;\r\n        cursor: pointer;\r\n    }\r\n  </style>\r\n  ","import script from \"./MqttData.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MqttData.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./MqttData.vue?vue&type=style&index=0&id=7041edc5&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7041edc5\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=364ecfdc\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=364ecfdc&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk_7_flip_display\"] = self[\"webpackChunk_7_flip_display\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(9921); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_UpdateCheck","_component_WifiConfig","_component_MqttData","installedFirmwareVersion","ref","installedWebAppVersion","availableFirmwareVersion","availableWebAppVersion","updateAvailable","firmwareState","webAppState","updateLabel","progress","showProgress","message","updateInProgress","async","fetchInstalledVersions","response","fetch","data","json","value","versions","firm_version","web_app_version","error","console","fetchAvailableVersions","firmware_version","checkForUpdate","progressInterval","startProgressPolling","setInterval","clearInterval","window","location","reload","startUpdate","updateFirmware","updateWebApp","method","headers","body","JSON","stringify","firmware_url","web_app_url","text","url","onMounted","__exports__","mode","selectedMode","ssid","password","fetchConfig","ok","updateConfig","payload","alert","config","enabled","broker","port","login","showSaveButton","SaveButtonLabel","Error","onInputChange","saveConfig","host","errText","name","components","UpdateCheck","WifiConfig","MqttData","render","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","Object","keys","every","key","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","g","globalThis","this","Function","e","obj","prop","prototype","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","id","chunkLoadingGlobal","self","forEach","bind","push","__webpack_exports__"],"sourceRoot":""}